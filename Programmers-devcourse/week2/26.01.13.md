## 💭 데이터베이스란

<aside>

> ***⚙️Database : 데이터를 통합해 효율적으로 관리하기 위한 데이터 집합체***
>
> 👉🏻 ***데이터를 구조화하여 관리함으로써 데이터 중복을 막고, 효율적이고 빠른 데이터 연산을 가능하게 함***

</aside>

<img width="581" height="400" alt="Image" src="https://github.com/user-attachments/assets/af327ad2-45d0-4da4-b442-0baafb31dd00" />

### 1. DBMS

<aside>

> ***⚙️DBMS(Database Management System) : 데이터베이스 관리 시스템으로, DB를 효율적으로 생성, 저장, 검색, 수정, 삭제 할 수 있도록 도와주는 SW 도구 집합***

</aside>

<img width="603" height="464" alt="Image" src="https://github.com/user-attachments/assets/498ed818-41d3-4f8b-bd83-4986258d26c9" />

<br>

운영회사는 다르지만, DB에 연산을 요청하기 위해 사용되는 주요 명령어는 동일함

<img width="700" height="448" alt="Image" src="https://github.com/user-attachments/assets/b49cd252-bab1-4bfd-8e3b-487a9a249910" />

<br>

### 2. SQL(Structured Query Language)

SQL은 DB에 연산을 요청하기 위해 사용되는 언어로 데이터를 생성, 조회, 수정, 삭제 등과 같은 기능을 수행할 수 있음

- 데이터 삽입 : INSERT
- 데이터 조회 : SELECT
- 데이터 수정 : UPDATE
- 데이터 삭제 : DELETE

<br>

## 💭 Docker

<aside>

> ⚙️ **컨테이너**를 사용해 각각의 프로그램을 **분리된 환경에서 실행 및 관리**할 수 있는 툴

</aside>

하나의 컴퓨터 환경 내에서 **독립적인 컴퓨터 환경**을 구성해서, 각 환경에 프로그램을 별도로 설치할 수 있게 만든 개념

하나의 컴퓨터 환경 내에서 여러 개의 **미니 컴퓨터 환경을 구성**할 수 있는 형태

👉🏻 ***미니 컴퓨터 = Docker Container***

<img width="683" height="468" alt="Image" src="https://github.com/user-attachments/assets/7948ead5-6c7e-4e8f-9248-856ba3488130" />

<br>

### 1. Docker로 MariaDB 설치

```bash
docker pull mariadb
docker run --name mariadb -d -p 3306:3306
	-restart=always -e MYSQL_ROOT_PASSWORD=root mariadb
docker exec -it mariadb /bin/bash // mariadb가 있는 컨테이너 접속
mysql -u root -p // mariadb 실행
```

<img width="1000" height="258" alt="Image" src="https://github.com/user-attachments/assets/b9d6eaa0-5afa-4d6b-b943-eae9dce7302e" />

<br>

## 💭 SQL

데이터를 저장할 방을 만들어보자

<img width="705" height="410" alt="Image" src="https://github.com/user-attachments/assets/c127d590-20af-417c-8496-b41f5edc63a4" />

<br>

### 1. CREATE 문

```sql
SHOW DATABASES;
```

<img width="690" height="396" alt="Image" src="https://github.com/user-attachments/assets/9d821b1f-7877-4d2a-9cda-bacaecb51541" />

<br>

```sql
CREATE DATABASE Tennis;
```

<img width="710" height="432" alt="Image" src="https://github.com/user-attachments/assets/0ec549ec-b8b4-43f8-a543-2de0ec1e9acd" />

<br>

- ***이후 실습은 DataGrip 을 통해 진행됩니다.***

<br>

Tennis 라는 방 안에 member 라는 테이블을 생성

```sql
CREATE TABLE member 
(
	id VARCHAR(30),
	name VARCHAR(30),
	pwd VARCHAR(30)
)
```

<img width="479" height="297" alt="Image" src="https://github.com/user-attachments/assets/d14a6162-1521-4cf8-8e57-3e06ce954988" />
<br>

### 2. SELECT, INSERT

**1️⃣ 테이블 데이터 조회**

```sql
SELECT 컬럼명 FROM 테이블명;
```

<br>

**2️⃣ 테이블 데이터 삽입**

```sql
INSERT 컬럼명1, 컬럼명2, ... INTO 테이블명 VALUES(컬럼1 데이터, 컬럼2 데이터, ...);
```

<br>

member 데이터를 삽입해보자

```sql
INSERT INTO member VALUES ('ssonCoding', 'kimsonga', 'aaaaa');
```

데이터가 잘 들어갔는지 확인해보자

```sql
SELECT * FROM member;
```

<img width="950" height="300" alt="Image" src="https://github.com/user-attachments/assets/b9202559-a489-4374-9942-970815b68120" />

<br>

나머지 member 데이터들을 삽입 후 조회해보자

```sql
INSERT INTO member VALUES ('tennisking', 'park songa', 'bbbbb');
INSERT INTO member VALUES ('programmer', 'song songa', 'ccccc');
```

<img width="900" height="304" alt="Image" src="https://github.com/user-attachments/assets/f5a5a8dd-53a6-43a4-8022-6c124b87a6b7" />

<br>

전체 조회가 아닌 특정 데이터를 조회해보자

```sql
SELECT * FROM member WHERE id = 'tennisking';
```

<img width="870" height="230" alt="Image" src="https://github.com/user-attachments/assets/d6495e9b-9e5e-4299-9480-601685f97257" />

<br>

### 3. UPDATE, DELETE

**3️⃣ 테이블 데이터 수정**

```sql
UPDATE 테이블명 SET 컬럼명 = 수정할 값 WHERE 조건;
// UPDATE member SET pwd = 'zzzzz' WHERE id = 'tennisking';
```

<img width="890" height="288" alt="Image" src="https://github.com/user-attachments/assets/bbac7540-5b0b-46b3-9f01-1cf20d59a629" />

<br>

모든 member 의 pwd 를 변경해보자

```sql
UPDATE member SET pwd = "sssss";
```

<img width="588" height="276" alt="Image" src="https://github.com/user-attachments/assets/ffa896b1-6eed-4eac-b297-bc844d2ce8fb" />

<br>

**4️⃣ 테이블 데이터 삭제**

❗️ **WHERE 절을 제외하면 테이블 데이터 전체 삭제가 가능함**

```sql
DELETE FROM 테이블명 WHRER 조건;
// DELETE FROM member WHERE name = 'park songa';
```

<img width="806" height="235" alt="Image" src="https://github.com/user-attachments/assets/8f57aa0e-1bfe-4ba7-8953-45308dfba410" />

<br>

- 데이터 전체 삭제

  <img width="346" height="212" alt="Image" src="https://github.com/user-attachments/assets/3782df41-470d-4b60-84c9-996c3a9a82bc" />

<br>

## 💭 Node.js 와 DB 연동

테니스 제품에 대한 테이블 설계를 해보자

<img width="532" height="331" alt="Image" src="https://github.com/user-attachments/assets/45c89c34-d53c-4da4-91ee-6fba8480b61b" />

<br>

제품에 대한 데이터를 삽입 후 조회해보자

<img width="890" height="305" alt="Image" src="https://github.com/user-attachments/assets/c1bea582-2e0e-4011-84b6-61c665d1727c" />

<br>

Node.js 와 연결해보기 전, `mysql` 모듈 설치

<br>

```bash
pnpm install mysql --save
```

<br>

- `database/connect/mariadb.js`

    ```jsx
    import mariadb from "mysql2";
    
    const connection = mariadb.createConnection({
      host: "localhost",
      port: 13306,
      user: "choonsik",
      password: "ralo2400",
      database: "devtutorial",
    });
    
    export default connection;
    ```

<br>

- `requestHandler.js`

    ```jsx
    import mariadb from "./database/connect/mariadb.js";
    
    function main(res) {
      console.log("main");
    
      mariadb.query("SELECT * FROM product", function (err, rows) {
        if (err) {
          console.log("에러 발생 상세 내용:", err);
          return;
        }
        console.log(rows);
      });
    
      res.writeHead(200, {"Content-Type": "text/html"});
      res.write("Main Page");
      res.end();
    }
    
    function login(res) {
      console.log("login");
    
      res.writeHead(200, {"Content-Type": "text/html"});
      res.write("Login Page");
      res.end();
    }
    
    const handle = {}; // key:value
    handle["/"] = main;
    handle["/login"] = login;
    
    export default handle;
    ```

<br>

## 💭 Main Page 연동

- `requestHandler.js`

    <img width="836" height="537" alt="Image" src="https://github.com/user-attachments/assets/533275b9-ee6b-4206-9ccf-b954fbb1f398" />

  ⌨️ `order` 에 대한 함수 구현

<br>

- `server.js`

  <img width="568" height="525" alt="Image" src="https://github.com/user-attachments/assets/1f6850a2-17e0-4787-b775-127bab493bfe" />

  ⌨️ 쿼리 파라미터 전부를 객체로 변환

<br>

SELECT 문으로 `orderlist` 확인

<img width="660" height="234" alt="Image" src="https://github.com/user-attachments/assets/e9d8a546-cbe1-4d9b-8664-218a07ecab38" />

<br>

## 💭 프로젝트 마무리

***orderlist 도 나올 수 있도록 마무리 지어보자***

- `requestHandler.js`

<img width="568" height="525" alt="Image" src="https://github.com/user-attachments/assets/1f6850a2-17e0-4787-b775-127bab493bfe" />

  ⌨️ MariaDB 데이터베이스에서 주문 목록을 가져와서 HTML 표(Table) 형태로 브라우저에 그려주는 함수

<br>

- 실습 결과

  <img width="532" height="436" alt="Image" src="https://github.com/user-attachments/assets/1d410898-2d7b-4e69-9924-a07ad8c0fcd9" />